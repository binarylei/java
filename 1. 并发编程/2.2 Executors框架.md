# Executors框架

Java 通过 Executors 提供四种线程池，分别为：

* `newFixedThreadPool` 创建一个固定数量的线程池，可控制线程最大并发数，超出的线程会在队列中等待。

	```java
	public static ExecutorService newFixedThreadPool(int nThreads) {
        return new ThreadPoolExecutor(nThreads, nThreads,
                                      0L, TimeUnit.MILLISECONDS,
                                      new LinkedBlockingQueue<Runnable>());
    }
    ```

* `newSingleThreadExecutor` 创建一个单线程的线程池，它只会用唯一的工作线程来执行任务，保证所有任务按照指定顺序(FIFO, LIFO, 优先级)执行。

	```java
	public static ExecutorService newSingleThreadExecutor() {
        return new FinalizableDelegatedExecutorService
            (new ThreadPoolExecutor(1, 1,
                                    0L, TimeUnit.MILLISECONDS,
                                    new LinkedBlockingQueue<Runnable>()));
    }
    ```

* `newCachedThreadPool` 创建一个可根据实际情况调整线程个数的线程池，不限制最大线程个数。当有任务提交时，用空闲线程执行任务，没有则创建一个线程，并且每个空闲线程会在60秒后自动回收。

	```java
	public static ExecutorService newCachedThreadPool() {
        return new ThreadPoolExecutor(0, Integer.MAX_VALUE,
                                      60L, TimeUnit.SECONDS,
                                      new SynchronousQueue<Runnable>());
    }
	```

* `newScheduledThreadPool` 创建一个定长线程池，支持定时及周期性任务执行。

	```java
	public ScheduledThreadPoolExecutor(int corePoolSize) {
        super(corePoolSize, Integer.MAX_VALUE, 0, NANOSECONDS,
              new DelayedWorkQueue());
    }
    ```

## 自定义线程池

```java
public ThreadPoolExecutor(
	int corePoolSize,		// 核心线程数
	int maximumPoolSize,	// 最大线程数
	long keepAliveTime,		// 空闲线程最大存活时间
	TimeUnit unit,			// 单位
	BlockingQueue<Runnable> workQueue,	// 任务队列
	ThreadFactory threadFactory,		// 
	RejectedExecutionHandler handler	// 拒绝任务时的操作
) {}
```

